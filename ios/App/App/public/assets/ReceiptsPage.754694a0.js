var de=Object.defineProperty;var ue=(e,t,l)=>t in e?de(e,t,{enumerable:!0,configurable:!0,writable:!0,value:l}):e[t]=l;var B=(e,t,l)=>(ue(e,typeof t!="symbol"?t+"":t,l),l);import{H as P,_ as Y,I as D,l as g,J as $,o as m,e as x,w as o,K as R,b as a,G as b,a as i,t as h,M as ce,N as q,O,P as T,Q as _e,V as S,d as y,c as C,F as L,p as G,S as J,i as ee,E as te,U as ve,W as pe,j as X,X as me,y as V,Y as K,Z as fe,$ as be,g as F,a0 as ge,a1 as Q,a2 as he,a3 as M,a4 as ye}from"./index.7ec09470.js";import{i as N}from"./ApiConfig.43556753.js";import{_ as Ae}from"./plugin-vue_export-helper.21dcd24c.js";var we="data:image/png;base64,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";const Ce="product",Ve="fiscal-funds",xe="fiscal-funds/lots";class Se{constructor(){B(this,"get_product_barcode",t=>N.post(Ce,t));B(this,"get_fiscal_found",()=>N.get(Ve));B(this,"get_lot_fiscal_found",t=>N.post(xe,t))}}const H=P("Dialog",{web:()=>Y(()=>import("./web.9a7de737.js"),["assets/web.9a7de737.js","assets/index.7ec09470.js","assets/index.136de0cf.css"]).then(e=>new e.DialogWeb)}),E=P("Toast",{web:()=>Y(()=>import("./web.78dd4bce.js"),["assets/web.78dd4bce.js","assets/index.7ec09470.js","assets/index.136de0cf.css"]).then(e=>new e.ToastWeb)});var W;(function(e){e.Dark="DARK",e.Light="LIGHT",e.Default="DEFAULT"})(W||(W={}));var Z;(function(e){e.Body="body",e.Ionic="ionic",e.Native="native",e.None="none"})(Z||(Z={}));const Ue=P("Keyboard");let k;const Ie=new Uint8Array(16);function Be(){if(!k&&(k=typeof crypto!="undefined"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!k))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return k(Ie)}const c=[];for(let e=0;e<256;++e)c.push((e+256).toString(16).slice(1));function Te(e,t=0){return(c[e[t+0]]+c[e[t+1]]+c[e[t+2]]+c[e[t+3]]+"-"+c[e[t+4]]+c[e[t+5]]+"-"+c[e[t+6]]+c[e[t+7]]+"-"+c[e[t+8]]+c[e[t+9]]+"-"+c[e[t+10]]+c[e[t+11]]+c[e[t+12]]+c[e[t+13]]+c[e[t+14]]+c[e[t+15]]).toLowerCase()}const ke=typeof crypto!="undefined"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);var z={randomUUID:ke};function Ee(e,t,l){if(z.randomUUID&&!t&&!e)return z.randomUUID();e=e||{};const _=e.random||(e.rng||Be)();if(_[6]=_[6]&15|64,_[8]=_[8]&63|128,t){l=l||0;for(let p=0;p<16;++p)t[l+p]=_[p];return t}return Te(_)}const Re={class:"menu_items_details"},Fe={class:"v-card-item"},Ne={class:"v-card-item__content"},Le={class:"d-flex align-center pb-2"},Pe=i("div",{class:"v-avatar v-theme--BLUE_THEME v-avatar--density-default rounded-md v-avatar--variant-flat",style:{width:"64px",height:"64px"}},[i("img",{src:we}),i("span",{class:"v-avatar__underlay"})],-1),De={class:"pl-5"},He={class:"d-flex align-center"},je={class:"col-12"},qe=["onSubmit"],Oe=["onSubmit"],Ge=i("option",{value:"null",disabled:"",selected:""},"Fuentes de financiamiento",-1),Je=["value"],Xe=i("option",{value:"null",disabled:"",selected:""},"Lote | Fecha de caducidad",-1),Ke=["value"],Qe={__name:"ReceiptsForm",setup(e){const t=D(),l=g(!1),_=g(0),p=g(!1),A=g([]),v=new Se,w=g([]),f=g([]),d=g({barcode:""}),n=g({barcode:"",fiscal_found:null,lot_fiscal_found:null,box_off:"",box:"",quantity:""}),U=()=>{n.value={barcode:"",fiscal_found:null,lot_fiscal_found:null,box_off:"",box:"",quantity:""},d.value={barcode:""}},j=()=>{Ue.hide()},ae=async()=>{const{value:u}=await H.confirm({okButtonTitle:"Si, guardar.",cancelButtonTitle:"Cancelar.",title:"Guardar",message:`Producto: ${d.value.name}
        Cantidad total: ${oe(n.value.box,n.value.box_off,n.value.quantity)}`});if(!!u)try{let r={id:Ee(),name:d.value.name,id_product:d.value.id_product,barcode:d.value.barcode,short_description:d.value.short_description,box_off:n.value.box_off,health_sector_key:d.value.ssa_key.health_sector_key,box:n.value.box,quantity:n.value.quantity,lot:n.value.lot_fiscal_found};t.commit("remission/SET_LIST",r),l.value=!1,_.value=0,U(),p.value=!1,t.commit("remission/SET_TAP_REMISSION",1),await E.show({text:"Producto agregado correctamente."})}catch(r){await E.show({text:r.message})}},oe=(u,r,s)=>parseInt(u)*parseInt(r)+parseInt(s),le=u=>{u.preventDefault(),re(d.value.barcode)},ne=()=>{d.value.barcode="",l.value=!1,p.value=!1},se=async()=>{if(n.value.lot_fiscal_found=null,n.value.fiscal_found==null){w.value=[];return}try{const u={fiscal_fund_id:n.value.fiscal_found},r=await v.get_lot_fiscal_found(u);w.value=r.data.data}catch(u){console.log("lot_fiscal_found: "+u.message)}},ie=async()=>{try{const u=await v.get_fiscal_found();f.value=u.data.data}catch(u){console.log("fiscal_found: "+u.message)}},re=u=>{const r={barcode:u};v.get_product_barcode(r).then(async s=>{const{data:I}=s;I.data!==null?(_.value=1,p.value=!0,d.value=I.data,console.log(I.data),d.value.id_product_lot_expiration=null,A.value=I.data.lots_expiration,l.value=!0,j(),await E.show({text:"Producto encontrado."})):(l.value=!1,_.value=0,U())}).catch(s=>{alert(s.message)})};return $(()=>{ie()}),(u,r)=>(m(),x(te,null,{default:o(()=>[R(a(b,{cols:"12",class:"pt-5 pb-0"},{default:o(()=>{var s;return[i("div",Re,[i("div",Fe,[i("div",Ne,[i("div",Le,[Pe,i("div",De,[i("h5",null,"Clave: "+h((s=d.value.ssa_key)==null?void 0:s.health_sector_key),1),i("h5",null,"Registro Sanitario: "+h(d.value.health_register),1)])]),i("div",He,[i("div",je,[i("h5",null,h(d.value.name),1)])])])])])]}),_:1},512),[[ce,l.value]]),a(b,{cols:"12",class:q([p.value?"pb-0":"pt-7"])},{default:o(()=>[i("form",{onSubmit:O(le,["prevent"])},[a(T,{dark:"",id:"barcode_botton",type:"text",class:q([p.value?"":"ean-product"]),autocomplete:"off","hide-details":"","append-inner-icon":"mdi mdi-barcode",variant:"outlined",modelValue:d.value.barcode,"onUpdate:modelValue":r[0]||(r[0]=s=>d.value.barcode=s),label:"EAN"},_e({_:2},[l.value?{name:"append",fn:o(()=>[a(S,{style:{color:"white","background-color":"#fa896b"},dark:"",onClick:ne,class:"mt-n2"},{default:o(()=>[y(" Cancelar ")]),_:1})]),key:"0"}:void 0]),1032,["class","modelValue"])],40,qe)]),_:1},8,["class"]),l.value?(m(),x(b,{key:0,cols:"12"},{default:o(()=>[i("form",{onSubmit:O(ae,["prevent"])},[a(b,{cols:"12 pl-0 pr-0 pt-1"},{default:o(()=>[R(i("select",{"onUpdate:modelValue":r[1]||(r[1]=s=>n.value.fiscal_found=s),onChange:r[2]||(r[2]=s=>se()),class:"v-select-input"},[Ge,(m(!0),C(L,null,G(f.value,s=>(m(),C("option",{key:s.value,value:s.value},h(s.text),9,Je))),128))],544),[[J,n.value.fiscal_found]])]),_:1}),a(b,{cols:"12 pl-0 pr-0 pt-1"},{default:o(()=>[R(i("select",{"onUpdate:modelValue":r[3]||(r[3]=s=>n.value.lot_fiscal_found=s),class:"v-select-input"},[Xe,(m(!0),C(L,null,G(w.value,s=>(m(),C("option",{key:s.value,value:s.value},h(s.text),9,Ke))),128))],512),[[J,n.value.lot_fiscal_found]])]),_:1}),a(b,{cols:"12 pl-0 pr-0 pt-1"},{default:o(()=>[a(T,{modelValue:n.value.box,"onUpdate:modelValue":r[4]||(r[4]=s=>n.value.box=s),"hide-details":"",variant:"outlined",type:"number","error-messages":u.errors,label:"Cantidad de cajas",required:""},null,8,["modelValue","error-messages"])]),_:1}),a(b,{cols:"12 pl-0 pr-0 pt-1"},{default:o(()=>[a(T,{modelValue:n.value.box_off,"onUpdate:modelValue":r[5]||(r[5]=s=>n.value.box_off=s),"hide-details":"",outlined:"",variant:"outlined",type:"number","error-messages":u.errors,label:"Cantidad de piezas en caja",required:""},null,8,["modelValue","error-messages"])]),_:1}),a(b,{cols:"12 pl-0 pr-0 pt-1"},{default:o(()=>[a(T,{modelValue:n.value.quantity,"onUpdate:modelValue":r[6]||(r[6]=s=>n.value.quantity=s),"hide-details":"",outlined:"",variant:"outlined",type:"number","error-messages":u.errors,label:"Cantidad fuera de caja",required:""},null,8,["modelValue","error-messages"])]),_:1}),a(b,{cols:"12 pl-0 pr-0 pt-1"},{default:o(()=>[a(S,{size:"large",style:{color:"white","background-color":"#13deb9"},dark:"",type:"submit",block:""},{default:o(()=>[y(" Guardar ")]),_:1})]),_:1})],40,Oe)]),_:1})):ee("",!0)]),_:1}))}};const Me={class:"card-header text-center"},We={key:0},Ze=i("div",{class:"text-center pt-2 pb-2"},[i("h5",null,"Sin productos")],-1),ze={key:1},Ye=i("i",{class:"mdi mdi-barcode mr-1"},null,-1),$e={__name:"ReceiptsListProducts",setup(e){const t=D(),l=t.state.remission,_=g(.12),p=g(window.innerHeight),A=(f,d,n)=>parseInt(f)*parseInt(d)+parseInt(n),v=ve(()=>l.listProducts.length>3&&l.listProducts.length<5?window.innerHeight>700?.4:.5:l.listProducts.length>3?window.innerHeight>700?.6:.59:l.listProducts.length>2?window.innerHeight>700?.6:.32:l.listProducts.length>1?window.innerHeight>700?.6:.23:_.value),w=async f=>{const{value:d}=await H.confirm({okButtonTitle:"Si, eliminar.",cancelButtonTitle:"Cancelar.",title:"Eliminaci\xF3n",message:`Producto: ${f.name}
        Cantidad total: ${A(f.box,f.box_off,f.quantity)}`});!d||t.commit("remission/REMOVE_REMISSION_LIST",f)};return(f,d)=>(m(),x(te,null,{default:o(()=>[a(b,{cols:"12",class:"pt-5"},{default:o(()=>[a(pe,{class:"mx-auto menu_items_details",variant:"outlined"},{default:o(()=>[i("div",Me,[a(X,{title:"Lista de productos"},{append:o(()=>[a(me,{color:"info",content:V(l).listProducts.length,inline:""},null,8,["content"])]),_:1})]),V(l).listProducts.length==0?(m(),C("div",We,[a(K,{class:"border-opacity-100",color:"info"}),Ze])):(m(),C("div",ze,[a(fe,{items:V(l).listProducts,height:p.value*v.value+"px","item-height":"60"},{default:o(({item:n,index:U})=>[a(K,{class:"border-opacity-100",color:"info"}),a(X,null,{prepend:o(()=>[a(be,{color:"#5D87FF",style:{color:"white"},size:"28"},{default:o(()=>[i("h6",null,h(U+1),1)]),_:2},1024)]),append:o(()=>[a(S,{onClick:j=>w(n),icon:"mdi-delete-outline",style:{color:"white","background-color":"#fa896b"},size:"x-small",variant:"tonal"},null,8,["onClick"])]),default:o(()=>[a(F,{class:"pb-0"},{default:o(()=>[i("h4",null,h(n.name),1)]),_:2},1024),a(F,{style:{"max-width":"220px",overflow:"hidden"},class:"pb-0"},{default:o(()=>[y(" Cant. Total: "),i("strong",null,h(A(n.box,n.box_off,n.quantity)),1),y(" | Clave: "),i("strong",null,h(n.health_sector_key),1)]),_:2},1024),a(F,null,{default:o(()=>[Ye,y(" EAN: "),i("strong",null,h(n.barcode),1)]),_:2},1024)]),_:2},1024)]),_:1},8,["items","height"])]))]),_:1})]),_:1}),!V(l).listProducts.length==0?(m(),x(b,{key:0,cols:"12",class:"pt-0"},{default:o(()=>[a(S,{size:"large",style:{color:"white","background-color":"#13deb9"},dark:"",block:""},{default:o(()=>[y(" Guardar ")]),_:1})]),_:1})):ee("",!0)]),_:1}))}};const et={__name:"ReceiptsPage",setup(e){const t=g("scronosXADAL_db"),l=D(),_=l.state.remission,p=A=>{l.commit("remission/SET_TAP_REMISSION",A)};return $(async()=>{const A=await ge.get({key:t.value}),v=JSON.parse(A.value);v!==null&&v.length>0&&(await H.alert({title:"Aviso.",message:"Se encontro un registro de recibo pendiente.",buttonTitle:"Si, confirmar."}),await E.show({text:"Lista cargada exitosamente!"}),l.commit("remission/SET_LIST_REPLACE",v))}),(A,v)=>(m(),C(L,null,[a(he,{modelValue:V(_).tabRemission,"onUpdate:modelValue":v[0]||(v[0]=w=>V(_).tabRemission=w)},{default:o(()=>[(m(),x(Q,{key:0,value:0},{default:o(()=>[a(Qe)]),_:1})),(m(),x(Q,{key:1,value:1},{default:o(()=>[a($e)]),_:1}))]),_:1},8,["modelValue"]),i("div",null,[a(ye,{class:"bottom_navigation",color:"#5D87FF",app:"",elevation:7,grow:"",value:V(_).tabRemission},{default:o(()=>[a(S,{value:"0",onClick:v[1]||(v[1]=w=>p(0))},{default:o(()=>[a(M,null,{default:o(()=>[y("mdi mdi-barcode")]),_:1}),y(" Capturar ")]),_:1}),a(S,{value:"1",onClick:v[2]||(v[2]=w=>p(1))},{default:o(()=>[a(M,null,{default:o(()=>[y("mdi-timetable")]),_:1}),y(" Lista ")]),_:1})]),_:1},8,["value"])])],64))}};var nt=Ae(et,[["__scopeId","data-v-603c74c1"]]);export{nt as default};
